import numpy as np
import matplotlib.cm as cm
import matplotlib.pyplot as plt
import matplotlib.cbook as cbook
from matplotlib import rc
rc('figure', figsize=(13,10))
rc('text', usetex=True)
rc('font', family='serif')
rc('axes', titlesize=42)
rc('axes', labelsize=32)
rc('xtick', labelsize=24)
rc('ytick', labelsize=24)
#rc('label', labelsize=14)

#os.environ['PATH'] = os.environ['PATH'] + ':/usr/texbin'
#A = np.random.rand(17, 72)


frequency_obs = np.array([
1419.26757812,1419.27001953,1419.27246094
,1419.27490234,1419.27734375,1419.27978516,1419.28222656,1419.28466797
,1419.28710938,1419.28955078,1419.29199219,1419.29443359,1419.296875
,1419.29931641,1419.30175781,1419.30419922,1419.30664062,1419.30908203
,1419.31152344,1419.31396484,1419.31640625,1419.31884766,1419.32128906
,1419.32373047,1419.32617188,1419.32861328,1419.33105469,1419.33349609
,1419.3359375, 1419.33837891,1419.34082031,1419.34326172,1419.34570312
,1419.34814453,1419.35058594,1419.35302734,1419.35546875,1419.35791016
,1419.36035156,1419.36279297,1419.36523438,1419.36767578,1419.37011719
,1419.37255859,1419.375, 1419.37744141,1419.37988281,1419.38232422
,1419.38476562,1419.38720703,1419.38964844,1419.39208984,1419.39453125
,1419.39697266,1419.39941406,1419.40185547,1419.40429688,1419.40673828
,1419.40917969,1419.41162109,1419.4140625, 1419.41650391,1419.41894531
,1419.42138672,1419.42382812,1419.42626953,1419.42871094,1419.43115234
,1419.43359375,1419.43603516,1419.43847656,1419.44091797,1419.44335938
,1419.44580078,1419.44824219,1419.45068359,1419.453125,1419.45556641
,1419.45800781,1419.46044922,1419.46289062,1419.46533203,1419.46777344
,1419.47021484,1419.47265625,1419.47509766,1419.47753906,1419.47998047
,1419.48242188,1419.48486328,1419.48730469,1419.48974609,1419.4921875
,1419.49462891,1419.49707031,1419.49951172,1419.50195312,1419.50439453
,1419.50683594,1419.50927734,1419.51171875,1419.51416016,1419.51660156
,1419.51904297,1419.52148438,1419.52392578,1419.52636719,1419.52880859
,1419.53125, 1419.53369141,1419.53613281,1419.53857422,1419.54101562
,1419.54345703,1419.54589844,1419.54833984,1419.55078125,1419.55322266
,1419.55566406,1419.55810547,1419.56054688,1419.56298828,1419.56542969
,1419.56787109,1419.5703125, 1419.57275391,1419.57519531,1419.57763672
,1419.58007812,1419.58251953,1419.58496094,1419.58740234,1419.58984375
,1419.59228516,1419.59472656,1419.59716797,1419.59960938,1419.60205078
,1419.60449219,1419.60693359,1419.609375,1419.61181641,1419.61425781
,1419.61669922,1419.61914062,1419.62158203,1419.62402344,1419.62646484
,1419.62890625,1419.63134766,1419.63378906,1419.63623047,1419.63867188
,1419.64111328,1419.64355469,1419.64599609,1419.6484375, 1419.65087891
,1419.65332031,1419.65576172,1419.65820312,1419.66064453,1419.66308594
,1419.66552734,1419.66796875,1419.67041016,1419.67285156,1419.67529297
,1419.67773438,1419.68017578,1419.68261719,1419.68505859,1419.6875
,1419.68994141,1419.69238281,1419.69482422,1419.69726562,1419.69970703
,1419.70214844,1419.70458984,1419.70703125,1419.70947266,1419.71191406
,1419.71435547,1419.71679688,1419.71923828,1419.72167969,1419.72412109
,1419.7265625, 1419.72900391,1419.73144531,1419.73388672,1419.73632812
,1419.73876953,1419.74121094,1419.74365234,1419.74609375,1419.74853516
,1419.75097656,1419.75341797,1419.75585938,1419.75830078,1419.76074219
,1419.76318359,1419.765625, 1419.76806641,1419.77050781,1419.77294922
,1419.77539062,1419.77783203,1419.78027344,1419.78271484,1419.78515625
,1419.78759766,1419.79003906,1419.79248047,1419.79492188,1419.79736328
,1419.79980469,1419.80224609,1419.8046875, 1419.80712891,1419.80957031
,1419.81201172,1419.81445312,1419.81689453,1419.81933594,1419.82177734
,1419.82421875,1419.82666016,1419.82910156,1419.83154297,1419.83398438
,1419.83642578,1419.83886719,1419.84130859,1419.84375, 1419.84619141
,1419.84863281,1419.85107422,1419.85351562,1419.85595703,1419.85839844
,1419.86083984,1419.86328125,1419.86572266,1419.86816406,1419.87060547
,1419.87304688,1419.87548828,1419.87792969,1419.88037109,1419.8828125
,1419.88525391,1419.88769531,1419.89013672,1419.89257812,1419.89501953
,1419.89746094,1419.89990234,1419.90234375,1419.90478516,1419.90722656
,1419.90966797,1419.91210938,1419.91455078,1419.91699219,1419.91943359
,1419.921875 ,1419.92431641,1419.92675781,1419.92919922,1419.93164062
,1419.93408203,1419.93652344,1419.93896484,1419.94140625,1419.94384766
,1419.94628906,1419.94873047,1419.95117188,1419.95361328,1419.95605469
,1419.95849609,1419.9609375, 1419.96337891,1419.96582031,1419.96826172
,1419.97070312,1419.97314453,1419.97558594,1419.97802734,1419.98046875
,1419.98291016,1419.98535156,1419.98779297,1419.99023438,1419.99267578
,1419.99511719,1419.99755859,1420., 1420.00244141,1420.00488281
,1420.00732422,1420.00976562,1420.01220703,1420.01464844,1420.01708984
,1420.01953125,1420.02197266,1420.02441406,1420.02685547,1420.02929688
,1420.03173828,1420.03417969,1420.03662109,1420.0390625, 1420.04150391
,1420.04394531,1420.04638672,1420.04882812,1420.05126953,1420.05371094
,1420.05615234,1420.05859375,1420.06103516,1420.06347656,1420.06591797
,1420.06835938,1420.07080078,1420.07324219,1420.07568359,1420.078125
,1420.08056641,1420.08300781,1420.08544922,1420.08789062,1420.09033203
,1420.09277344,1420.09521484,1420.09765625,1420.10009766,1420.10253906
,1420.10498047,1420.10742188,1420.10986328,1420.11230469,1420.11474609
,1420.1171875, 1420.11962891,1420.12207031,1420.12451172,1420.12695312
,1420.12939453,1420.13183594,1420.13427734,1420.13671875,1420.13916016
,1420.14160156,1420.14404297,1420.14648438,1420.14892578,1420.15136719
,1420.15380859,1420.15625 , 1420.15869141,1420.16113281,1420.16357422
,1420.16601562,1420.16845703,1420.17089844,1420.17333984,1420.17578125
,1420.17822266,1420.18066406,1420.18310547,1420.18554688,1420.18798828
,1420.19042969,1420.19287109,1420.1953125, 1420.19775391,1420.20019531
,1420.20263672,1420.20507812,1420.20751953,1420.20996094,1420.21240234
,1420.21484375,1420.21728516,1420.21972656,1420.22216797,1420.22460938
,1420.22705078,1420.22949219,1420.23193359,1420.234375,1420.23681641
,1420.23925781,1420.24169922,1420.24414062,1420.24658203,1420.24902344
,1420.25146484,1420.25390625,1420.25634766,1420.25878906,1420.26123047
,1420.26367188,1420.26611328,1420.26855469,1420.27099609,1420.2734375
,1420.27587891,1420.27832031,1420.28076172,1420.28320312,1420.28564453
,1420.28808594,1420.29052734,1420.29296875,1420.29541016,1420.29785156
,1420.30029297,1420.30273438,1420.30517578,1420.30761719,1420.31005859
,1420.3125,1420.31494141,1420.31738281,1420.31982422,1420.32226562
,1420.32470703,1420.32714844,1420.32958984,1420.33203125,1420.33447266
,1420.33691406,1420.33935547,1420.34179688,1420.34423828,1420.34667969
,1420.34912109,1420.3515625, 1420.35400391,1420.35644531,1420.35888672
,1420.36132812,1420.36376953,1420.36621094,1420.36865234,1420.37109375
,1420.37353516,1420.37597656,1420.37841797,1420.38085938,1420.38330078
,1420.38574219,1420.38818359,1420.390625,1420.39306641,1420.39550781
,1420.39794922,1420.40039062,1420.40283203,1420.40527344,1420.40771484
,1420.41015625,1420.41259766,1420.41503906,1420.41748047,1420.41992188
,1420.42236328,1420.42480469,1420.42724609,1420.4296875, 1420.43212891
,1420.43457031,1420.43701172,1420.43945312,1420.44189453,1420.44433594
,1420.44677734,1420.44921875,1420.45166016,1420.45410156,1420.45654297
,1420.45898438,1420.46142578,1420.46386719,1420.46630859,1420.46875
,1420.47119141,1420.47363281,1420.47607422,1420.47851562,1420.48095703
,1420.48339844,1420.48583984,1420.48828125,1420.49072266,1420.49316406
,1420.49560547,1420.49804688,1420.50048828,1420.50292969,1420.50537109
,1420.5078125, 1420.51025391,1420.51269531,1420.51513672,1420.51757812
,1420.52001953,1420.52246094,1420.52490234,1420.52734375,1420.52978516
,1420.53222656,1420.53466797,1420.53710938,1420.53955078,1420.54199219
,1420.54443359,1420.546875,1420.54931641,1420.55175781,1420.55419922
,1420.55664062,1420.55908203,1420.56152344,1420.56396484,1420.56640625
,1420.56884766,1420.57128906,1420.57373047,1420.57617188,1420.57861328
,1420.58105469,1420.58349609,1420.5859375, 1420.58837891,1420.59082031
,1420.59326172,1420.59570312,1420.59814453,1420.60058594,1420.60302734
,1420.60546875,1420.60791016,1420.61035156,1420.61279297,1420.61523438
,1420.61767578,1420.62011719,1420.62255859,1420.625, 1420.62744141
,1420.62988281,1420.63232422,1420.63476562,1420.63720703,1420.63964844
,1420.64208984,1420.64453125,1420.64697266,1420.64941406,1420.65185547
,1420.65429688,1420.65673828,1420.65917969,1420.66162109,1420.6640625
,1420.66650391,1420.66894531,1420.67138672,1420.67382812,1420.67626953
,1420.67871094,1420.68115234,1420.68359375,1420.68603516,1420.68847656
,1420.69091797,1420.69335938,1420.69580078,1420.69824219,1420.70068359
,1420.703125,1420.70556641,1420.70800781,1420.71044922,1420.71289062
,1420.71533203,1420.71777344,1420.72021484,1420.72265625,1420.72509766
,1420.72753906,1420.72998047,1420.73242188,1420.73486328,1420.73730469
,1420.73974609,1420.7421875, 1420.74462891,1420.74707031,1420.74951172
,1420.75195312,1420.75439453,1420.75683594,1420.75927734,1420.76171875
,1420.76416016,1420.76660156,1420.76904297,1420.77148438,1420.77392578
,1420.77636719,1420.77880859,1420.78125, 1420.78369141,1420.78613281
,1420.78857422,1420.79101562,1420.79345703,1420.79589844,1420.79833984
,1420.80078125,1420.80322266,1420.80566406,1420.80810547,1420.81054688
,1420.81298828,1420.81542969,1420.81787109,1420.8203125, 1420.82275391
,1420.82519531,1420.82763672,1420.83007812,1420.83251953,1420.83496094
,1420.83740234,1420.83984375,1420.84228516,1420.84472656,1420.84716797
,1420.84960938,1420.85205078,1420.85449219,1420.85693359,1420.859375
,1420.86181641,1420.86425781,1420.86669922,1420.86914062,1420.87158203
,1420.87402344,1420.87646484,1420.87890625,1420.88134766,1420.88378906
,1420.88623047,1420.88867188,1420.89111328,1420.89355469,1420.89599609
,1420.8984375, 1420.90087891,1420.90332031,1420.90576172,1420.90820312
,1420.91064453,1420.91308594,1420.91552734,1420.91796875,1420.92041016
,1420.92285156,1420.92529297,1420.92773438,1420.93017578,1420.93261719
,1420.93505859,1420.9375,1420.93994141,1420.94238281,1420.94482422
,1420.94726562,1420.94970703,1420.95214844,1420.95458984,1420.95703125
,1420.95947266,1420.96191406,1420.96435547,1420.96679688,1420.96923828
,1420.97167969,1420.97412109,1420.9765625, 1420.97900391,1420.98144531
,1420.98388672,1420.98632812,1420.98876953,1420.99121094,1420.99365234
,1420.99609375,1420.99853516,1421.00097656,1421.00341797,1421.00585938
,1421.00830078,1421.01074219,1421.01318359,1421.015625,1421.01806641
,1421.02050781,1421.02294922,1421.02539062,1421.02783203,1421.03027344
,1421.03271484,1421.03515625,1421.03759766,1421.04003906,1421.04248047
,1421.04492188,1421.04736328,1421.04980469,1421.05224609,1421.0546875
,1421.05712891,1421.05957031,1421.06201172,1421.06445312,1421.06689453
,1421.06933594,1421.07177734,1421.07421875,1421.07666016,1421.07910156
,1421.08154297,1421.08398438,1421.08642578,1421.08886719,1421.09130859
,1421.09375, 1421.09619141,1421.09863281,1421.10107422,1421.10351562
,1421.10595703,1421.10839844,1421.11083984,1421.11328125,1421.11572266
,1421.11816406,1421.12060547,1421.12304688,1421.12548828,1421.12792969
,1421.13037109,1421.1328125, 1421.13525391,1421.13769531,1421.14013672
,1421.14257812,1421.14501953,1421.14746094,1421.14990234,1421.15234375
,1421.15478516,1421.15722656,1421.15966797,1421.16210938,1421.16455078
,1421.16699219,1421.16943359,1421.171875 ,1421.17431641,1421.17675781
,1421.17919922,1421.18164062,1421.18408203,1421.18652344,1421.18896484
,1421.19140625,1421.19384766,1421.19628906,1421.19873047,1421.20117188
,1421.20361328,1421.20605469,1421.20849609,1421.2109375, 1421.21337891
,1421.21582031,1421.21826172,1421.22070312,1421.22314453,1421.22558594
,1421.22802734,1421.23046875,1421.23291016,1421.23535156,1421.23779297
,1421.24023438,1421.24267578,1421.24511719,1421.24755859])

frequency_obs = frequency_obs#-0.035

def nan_helper(y):
    """Helper to handle indices and logical indices of NaNs.

    Input:
        - y, 1d numpy array with possible NaNs
    Output:
        - nans, logical indices of NaNs
        - index, a function, with signature indices= index(logical_indices),
          to convert logical indices of NaNs to 'equivalent' indices
    Example:
        >>> # linear interpolation of NaNs
        >>> nans, x= nan_helper(y)
        >>> y[nans]= np.interp(x(nans), x(~nans), y[~nans])
    """

    return np.isnan(y), lambda z: z.nonzero()[0]

redshift = np.array([
 -1.62976813e+00,-1.05369139e+00,-5.22672534e-01, 3.05547506e-01,
  4.27597165e-02,-1.04026461e+00,-1.46253955e+00,-4.59409893e-01,
 -1.66018978e-01,-7.30241597e-01,-1.61688578e+00,-7.43486822e-01,
 -7.68223345e-01,-4.51003104e-01, 7.49413908e-01, 1.23597956e+00,
  2.53020191e+00, 2.68110061e+00, 1.52302003e+00, 4.69570637e-01,
  3.89313012e-01, 6.36254907e-01, 4.01469588e-01,-2.97322154e-01,
 -1.17664814e+00, 1.01607246e-02, 1.01903605e+00,-3.50968361e-01,
 -2.39563271e-01, 1.14392829e+00, 2.09643579e+00, 9.34907615e-01,
  1.40617177e-01,-5.13056099e-01,-1.96017310e-01, 2.62787789e-01,
 -1.29004920e+00, 0.00000000e+00,-8.53984714e-01, 8.61847162e-01,
  7.20927566e-02,-1.46641028e+00,-2.43736431e-02, 1.48231661e+00,
  1.64773083e+00, 3.38086009e-01, 9.36238170e-02, 5.25091708e-01,
  5.96035361e-01,-1.04334915e+00,-1.78574729e+00,-1.31605577e+00,
 -1.27317512e+00,-1.06246102e+00,-9.80691373e-01,-7.28608608e-01,
  4.89892066e-03,-4.64732200e-01,-8.14551413e-01,-6.29118204e-01,
  8.61847177e-02, 2.89096802e-01, 8.85434598e-02, 6.16598725e-01,
  1.64373910e+00, 1.09251976e+00,-4.09876376e-01,-2.11137444e-01,
 -2.56316364e-01,-1.29186356e+00,-4.92069364e-01, 5.29990673e-01,
 -8.37534010e-01,-1.21432757e+00, 1.80836711e-02, 8.99768472e-01,
  6.85002208e-01,-1.90815985e-01,-6.54882908e-01,-4.46285635e-01,
  6.20529950e-02,-4.93520908e-02,-3.71047884e-01, 6.04986489e-01,
  2.40905952e+00, 2.94606590e+00, 2.02730656e+00, 1.53765631e+00,
  1.93743241e+00, 1.33480465e+00, 7.03388229e-02,-6.30811676e-02,
  4.54208583e-01, 4.16347772e-01, 1.29023063e+00, 1.89636624e+00,
  1.71456182e+00, 2.47455978e+00, 1.91469181e+00, 4.37697411e-01,
  8.39832246e-01, 1.25285363e+00, 5.33075154e-01, 9.88856256e-02,
 -3.79636109e-01,-2.12468013e-01, 1.53983366e+00, 1.95642328e+00,
  9.58011150e-01, 1.36099279e+00, 1.46072507e+00, 7.37741172e-01,
  7.15302885e-01, 7.58788407e-01, 2.37446451e+00, 2.56352663e+00,
  1.66654027e+00, 8.27736199e-01, 1.23095965e+00, 1.54394627e+00,
  6.25307918e-01, 1.37151635e+00, 2.71442556e+00, 2.94630766e+00,
  2.60023832e+00, 2.76825309e+00, 3.06043434e+00, 5.06917334e+00,
  4.04789972e+00, 1.81501997e+00, 2.26348281e+00, 2.41958308e+00,
  1.89751530e+00, 8.96744430e-01,-1.32210374e-01, 7.93383241e-01,
  2.29807758e+00, 2.47504354e+00, 2.42932034e+00, 2.28005457e+00,
  1.32161999e+00, 1.33450234e+00, 1.38052797e+00, 4.94972438e-01,
  7.16391563e-01, 1.15795970e+00, 1.99349785e+00, 2.54477763e+00,
  2.15643239e+00, 2.00299335e+00, 2.85879254e+00, 3.19046760e+00,
  1.83177304e+00, 2.35934451e-01, 7.70824015e-01, 7.31027842e-01,
  6.66192770e-01, 1.31218505e+00, 2.15365028e+00, 2.28634453e+00,
  2.01267028e+00, 2.52088785e+00, 2.82685876e+00, 2.46960044e+00,
  5.92527509e-01,-6.26094162e-01, 1.04631267e-01, 1.51630676e+00,
  2.18298340e+00, 2.61560035e+00, 3.21810722e+00, 1.62662315e+00,
  8.11587870e-01, 1.86564207e+00, 2.25797915e+00, 1.32161999e+00,
  1.14344442e+00, 1.60853946e+00, 1.40611124e+00, 2.87838817e+00,
  3.49873662e+00, 3.37039709e+00, 3.49365640e+00, 1.71190059e+00,
  1.56620312e+00, 3.27870846e+00, 3.58734059e+00, 2.94648910e+00,
  1.98327672e+00, 1.85372740e-01,-3.25506061e-01, 1.07564580e+00,
  2.33642244e+00, 3.62574577e+00, 4.08285713e+00, 2.52530289e+00,
  2.04466438e+00, 2.91721654e+00, 2.69241047e+00, 1.68589401e+00,
  2.82335091e+00, 2.40083408e+00, 3.01755381e+00, 4.89384031e+00,
  4.19734716e+00, 1.66339529e+00, 4.95819181e-01, 1.58779466e+00,
  3.16960168e+00, 4.04638767e+00, 4.26109362e+00, 3.93401480e+00,
  2.41795015e+00, 1.72448063e+00, 2.39381838e+00, 3.21816754e+00,
  3.01731181e+00, 3.85363626e+00, 4.79005575e+00, 4.61079168e+00,
  2.64898562e+00, 2.96886706e+00, 5.79893112e+00, 5.16068029e+00,
  3.48186255e+00, 2.78863502e+00, 2.50661445e+00, 1.83122873e+00,
  3.25058508e+00, 3.16470289e+00, 1.83401084e+00, 4.60196137e-01,
  1.54467201e+00, 4.19220591e+00, 4.97899675e+00, 4.77130699e+00,
  3.37251377e+00, 2.67444777e+00, 3.40656447e+00, 3.50121641e+00,
  3.35406733e+00, 3.67842412e+00, 3.56974077e+00, 4.49944687e+00,
  4.83245277e+00, 3.92421699e+00, 5.12021875e+00, 6.71883965e+00,
  7.40118074e+00, 7.94393253e+00, 6.18165159e+00, 4.10674715e+00,
  3.94308686e+00, 4.50428534e+00, 4.18833542e+00, 5.54170752e+00,
  5.76082850e+00, 4.99157667e+00, 6.56642866e+00, 9.26978588e+00,
  8.82005310e+00, 6.51913309e+00, 5.91831970e+00, 6.89979744e+00,
  7.17081022e+00, 7.46982622e+00, 6.77212286e+00, 6.41988468e+00,
  7.88351250e+00, 8.83438683e+00, 7.55117226e+00, 8.15906143e+00,
  9.87918758e+00, np.nan, 1.07854881e+01, 1.12860250e+01,
  1.08717937e+01, 1.08676205e+01, 9.60019112e+00, 9.01721954e+00,
  8.95177937e+00, 1.00475054e+01, 1.20752354e+01, 1.16786642e+01,
  1.09148560e+01, 1.22127075e+01, 1.35022116e+01, 1.33886299e+01,
  1.49485426e+01, 1.67102795e+01, 1.71622505e+01, 1.78461037e+01,
             np.nan,             np.nan,             np.nan,             np.nan,
             np.nan,             np.nan,             np.nan,             np.nan,
             np.nan,             np.nan,             np.nan,             np.nan,
             np.nan,             np.nan,             np.nan,             np.nan,
             np.nan,             np.nan,  np.nan, 2.84190025e+01,
  2.84019470e+01, 2.86632824e+01, 2.93759861e+01, 3.13420258e+01,
  3.43495407e+01, 3.39337959e+01, 3.37675362e+01, 3.45986595e+01,
  3.67478943e+01, 3.70072937e+01, 3.61849403e+01, 3.73240318e+01,
  3.99995079e+01, 4.10450935e+01, 4.16985855e+01, 4.32176743e+01,
  4.56212311e+01, 4.73114166e+01, 5.00738029e+01, 5.32037315e+01,
  5.50962257e+01, 5.40285645e+01, 5.41636772e+01, 5.61619530e+01,
  5.72410469e+01, 5.83888474e+01, 6.03928680e+01, 6.20531158e+01,
  6.13247490e+01, 6.01581421e+01, 6.19368744e+01, 6.36444206e+01,
  6.35544853e+01, 6.23895111e+01, 6.15838509e+01, 6.07394218e+01,
  6.03756294e+01, 5.86625786e+01, 5.76399155e+01, 5.88372498e+01,
  5.87245140e+01, 5.70593643e+01, 5.59887390e+01, 5.38117409e+01,
  5.42311745e+01, 5.73265648e+01, 5.79669952e+01, 5.77063217e+01,
  5.73816643e+01, 5.77668037e+01, 5.83520126e+01, 5.84169693e+01,
  5.75843353e+01, 5.75641327e+01, 6.03124275e+01, 6.26258659e+01,
  6.36808281e+01, 6.32302513e+01, 6.20782166e+01, 6.27527542e+01,
  6.56288452e+01, 6.67895279e+01, 6.59065704e+01, 6.52942657e+01,
  6.65880051e+01, 6.79728851e+01, 6.91408844e+01, 7.01819992e+01,
  7.02391510e+01, 7.01924591e+01, 7.18036652e+01, 7.26527481e+01,
  7.33765182e+01, 7.34845352e+01, 7.37614136e+01, 7.55986328e+01,
  7.65440063e+01, 7.57737274e+01, 7.62511597e+01, 7.75355835e+01,
  7.63273621e+01, 7.48843002e+01, 7.58755722e+01, 7.73251114e+01,
  7.51683731e+01, 7.30742340e+01, 7.40721054e+01, 7.59483337e+01,
  7.61433182e+01, 7.27314911e+01, 7.04508972e+01, 6.88901978e+01,
  6.63284836e+01, 6.54099655e+01, 6.42339859e+01, 6.24270668e+01,
  6.16061668e+01, 5.99545059e+01, 6.05985603e+01, 6.22990913e+01,
  6.09427567e+01, 6.12087479e+01, 6.31784172e+01, 6.44094391e+01,
  6.75454712e+01, 7.03965225e+01, 7.33653946e+01, 7.57128830e+01,
  7.56883850e+01, 7.76243057e+01, 8.04110031e+01, 8.32219620e+01,
  8.52542877e+01, 8.56465607e+01, 8.78217468e+01, 9.29462585e+01,
  9.62423248e+01, 9.77369156e+01, 1.00515816e+02, 1.01700691e+02,
  1.03504700e+02, 1.06770767e+02, 1.10668015e+02, 1.14171524e+02,
  1.15323502e+02, 1.16347977e+02, 1.18247787e+02, 1.18168625e+02,
  1.15960480e+02, 1.13575554e+02, 1.13615227e+02, 1.12954659e+02,
  1.11814537e+02, 1.07999733e+02, 1.02743431e+02, 9.83898621e+01,
  9.49624329e+01, 9.27166748e+01, 8.89416580e+01, 8.32137909e+01,
  7.82693939e+01, 7.62138443e+01, 7.40555344e+01, 7.02396393e+01,
  6.72638168e+01, 6.52131653e+01, 6.36083145e+01, 6.27707176e+01,
  6.12471542e+01, 5.91006393e+01, 5.88424492e+01, 6.03560333e+01,
  6.23025398e+01, 6.59431610e+01, 7.01440201e+01, 7.25254974e+01,
  7.38434296e+01, 7.75949707e+01, 7.98528290e+01, 7.99905472e+01,
  8.02137833e+01, 8.13020020e+01, 7.88750458e+01, 7.30213776e+01,
  6.91392517e+01, 6.68853302e+01, 6.51434326e+01, 6.28353729e+01,
  5.73540840e+01, 5.14143562e+01, 4.80673027e+01, 4.42062263e+01,
  4.00915565e+01, 3.62026634e+01, 3.19753761e+01, 2.82176018e+01,
  2.41307526e+01, 2.06295376e+01, 1.90254726e+01, 1.84833260e+01,
  1.77860451e+01, 1.73293571e+01, 1.51129894e+01, 1.26449003e+01,
  1.13293896e+01, 1.08823175e+01, 1.01745138e+01, 1.15860081e+01,
  1.17438021e+01, 1.02715244e+01, 7.97453594e+00, 7.25681353e+00,
  8.52720642e+00, 8.86426449e+00, 7.92264366e+00, 7.69680929e+00,
  6.91449404e+00, 6.44389534e+00, 7.25887012e+00, 7.64334440e+00,
  7.39948702e+00, 6.89816427e+00, 5.34907722e+00, 5.12904930e+00,
  5.14380646e+00, 4.32036448e+00, 4.96865463e+00, 5.52967215e+00,
  5.51987410e+00, 3.93673635e+00, 2.71853805e+00, 3.22681642e+00,
  5.40725946e+00, 6.50358963e+00, 6.03873634e+00, 6.17965603e+00,
  6.48901367e+00, 4.95879650e+00, 3.71362376e+00, 5.50947142e+00,
  7.07416248e+00, 7.63155079e+00, 5.43338680e+00, 4.12501240e+00,
  4.19916153e+00, 4.38060284e+00, 5.32113504e+00, 4.21500731e+00,
  3.47629833e+00, 4.80154705e+00, 6.47449827e+00, 7.48990536e+00,
  6.50365019e+00, 4.81092167e+00, 4.82362270e+00, 6.19259882e+00,
  7.25505972e+00, 8.08745289e+00, 8.18567371e+00, 8.53645992e+00,
  8.43842125e+00, 8.32937527e+00, 8.59325123e+00, 7.58383179e+00,
  6.23330212e+00, 7.04918432e+00, 8.60129547e+00, 8.94669914e+00,
  6.43669796e+00, 4.75588417e+00, 4.28165674e+00, 4.86493063e+00,
  6.90318441e+00, 7.47920036e+00, 6.87282276e+00, 5.95569658e+00,
  4.91670227e+00, 5.11610603e+00, 6.90276098e+00, 7.36108208e+00,
  6.93874693e+00, 8.17357731e+00, 8.76132679e+00, 8.81243229e+00,
  8.42408752e+00, 8.26949883e+00, 7.29394865e+00, 6.67753124e+00,
  6.50371027e+00, 6.01061296e+00, 6.45006418e+00, 7.38110113e+00,
  7.56822777e+00, 7.85067177e+00, 7.17540693e+00, 6.99898529e+00,
  7.02722979e+00, 7.57070732e+00, 7.86016703e+00, 6.41619539e+00,
  6.89737797e+00, 7.92615128e+00, 7.47333384e+00, 5.99367857e+00,
  5.16128540e+00, 6.17469645e+00, 7.76932526e+00, 8.23018646e+00,
  7.08898020e+00, 5.17005491e+00, 4.62458134e+00, 6.76420021e+00,
  9.12330246e+00, 9.23210716e+00, 9.90567875e+00, 9.14949036e+00,
  6.88975763e+00, 6.39756727e+00, 7.31916904e+00, 8.68875027e+00,
  8.63709927e+00, 7.81825399e+00, 8.00767899e+00, 8.69618893e+00,
  8.96689987e+00, 8.19353580e+00, 8.69582653e+00, 1.12483454e+01,
  1.11965141e+01, 1.01813488e+01, 1.06832161e+01, 9.59638119e+00,
  7.16276646e+00, 7.17589092e+00, 8.97657681e+00, 8.76398754e+00,
  8.95758629e+00, np.nan, np.nan, np.nan,
  1.06228561e+01, 9.72018433e+00, 8.94246578e+00, 8.29314709e+00,
  8.23810959e+00, 8.76924992e+00, 8.57262707e+00, 8.64157486e+00,
  8.98316956e+00, 9.51321983e+00, 9.02411461e+00, 9.64924049e+00,
  8.93121624e+00, 7.61776114e+00, 8.24409771e+00, 9.04691601e+00,
  8.66637230e+00, 8.48366070e+00, 8.23327160e+00, 9.68407726e+00,
  1.12561474e+01, 1.12360077e+01, 9.47802067e+00, 1.05372763e+01,
  1.17339430e+01, 1.10263824e+01, 1.11460123e+01, 1.14511366e+01,
  1.04999599e+01, 9.20966911e+00, 9.23942471e+00, 8.53246880e+00,
  8.36463547e+00, 8.98159695e+00, 9.05181408e+00, 1.02997084e+01,
  1.19732046e+01, 1.15461512e+01, 9.83431149e+00, 1.08793535e+01,
  1.16498756e+01, 9.30728436e+00, 1.01576405e+01, 1.25966377e+01,
  1.21417027e+01, 1.11758900e+01, 1.00369205e+01, 9.06149101e+00,
  8.93919945e+00, 9.32984352e+00, 1.07904472e+01, 1.16587057e+01,
  1.06484394e+01, 1.05072174e+01, 1.25739574e+01, 1.35305777e+01,
  1.18700247e+01, 1.03144665e+01, 1.11989326e+01, 1.19789495e+01,
  1.04861097e+01, 8.94736481e+00, 1.10798464e+01, 1.22407703e+01,
  1.03453712e+01, 1.03182154e+01, 1.11530886e+01, 1.09845295e+01,
  1.06951904e+01, 1.03477907e+01, 1.08021202e+01, 1.07712145e+01,
  9.93404388e+00, 9.92394352e+00, 9.63702393e+00, 9.40272236e+00,
  9.94783306e+00, 1.11538754e+01, 1.15702229e+01, 1.04593773e+01,
  9.84580231e+00, 1.13596897e+01, 1.19361296e+01, 1.26322603e+01,
  1.24513025e+01, 1.17710180e+01, 1.17171297e+01, 1.08815918e+01,
  9.11652851e+00, 8.83233070e+00, 1.12832432e+01, 1.28233185e+01,
  1.21819229e+01, 1.30711069e+01, 1.24863205e+01, 1.14948645e+01,
  1.06774702e+01, 9.84743595e+00, 1.09637241e+01, 1.19734459e+01,
  1.17092676e+01, 1.08769350e+01, 1.20316286e+01, 1.41537075e+01,
  1.39425097e+01, 1.22261944e+01, 1.10907936e+01, 1.00721807e+01,
  9.04661369e+00, 9.34242344e+00, 1.03015833e+01, 1.17851706e+01,
  1.17664824e+01, 1.14220457e+01, 1.20412445e+01, 1.22161541e+01,
  1.20341082e+01, 1.24854746e+01, 1.17356977e+01, 1.09732199e+01,
  1.03189411e+01, 1.06290855e+01, 1.18974829e+01, 1.06011438e+01,
  9.92745113e+00, 9.75514221e+00, 9.60787201e+00, 1.13826723e+01,
  1.27293320e+01, 1.21069870e+01, 1.17792435e+01, 1.20263662e+01,
  1.18970594e+01, 1.20279388e+01, 1.24994450e+01, 1.09485435e+01,
  9.51926804e+00, 1.03717413e+01, 1.11264172e+01, 1.09051189e+01,
  1.14949846e+01, 9.84187126e+00, 7.68822098e+00, 8.11297607e+00,
  9.42177391e+00, 1.01304846e+01, 1.03558350e+01, 9.99143982e+00,
  9.54860115e+00, 8.52533150e+00, 6.66277409e+00, 7.24489880e+00,
  9.99397945e+00, 1.10898256e+01, 9.70439911e+00, 9.13824081e+00,
  1.07431517e+01, 1.07767181e+01, 8.85452747e+00, 8.63873291e+00,
  1.03480330e+01, 1.12986650e+01, 1.03147688e+01, 8.48565674e+00,
  8.16964626e+00, 8.79634476e+00, 7.34517574e+00, 5.00760412e+00,
  5.89830065e+00, 5.85874653e+00, 5.26948500e+00, 4.51057529e+00,
  4.10202980e+00, 4.75346518e+00, 5.71359301e+00, 6.17179346e+00,
  5.84562206e+00, 6.04424000e+00, 8.07916737e+00, 8.53966522e+00])

#bad = np.array([10.58575378,15.68324347,17.37299725,16.29080468,14.1655282,11.50625738,11.6556526,13.11997617,11.9194487,11.89772021,10.93812124,9.422198964,8.494051813,6.676873575,6.65212228,5.800888083,4.786986528,4.057004145,3.287536788,2.593640415,2.382300518,1.851358549,1.62838342,1.412437306,1.188679793,1.002267358,0.8800176166,0.7447927461,0.8089419689,0.5944404145,0.4184300518,0.3130051813,0.343319171,0.151280829,0.07893678756,0.06393056995,0.0215865285,0.01256580311,0,-0.01730466321,-0.01576062176,-0.02709430052,0.06215647668,0.0815388601,-0.02430984456,0.1658974093,0.3024891192,0.1736062176,0.326465285,0.2416259067,0.4663067358,0.4640880829,0.6095668394,0.649184456,0.8745544041,0.8708518135,1.014596891,1.699566839,2.125698446,2.740105699,3.507556477,4.435884974,4.971729534,6.360928497,7.292078756,8.850944041,10.0560943,11.58700829,13.35521554,nan,19.39499586,11.83104873])


#nans, x= nan_helper(bad)
#bad[nans]= np.interp(x(nans), x(~nans), bad[~nans])

A = np.array( [[10.8802829,10.71898756,9.951258031,10.38006218,9.940593782,9.479456995,10.12522591,8.67534715,8.520492228,7.374159585,6.724346114,6.506810363,5.335709845,5.293619689,4.471882902,3.692056995,3.160068394,2.755187565,2.703818653,2.089507772,1.746948187,1.528548187,1.253760622,1.098318135,0.9142725389,0.8536331606,0.8225554404,0.648961658,0.656161658,0.5829357513,0.379415544,0.3018663212,0.1756227979,0.1168673575,0.03963419689,0.08168393782,0.07357720207,0.08052746114,0.02824559585,0.0594507772,0.01832227979,0.01235025907,-0.06483212435,0,0.01632331606,0.02138341969,0.06758756477,0.2074362694,0.2736300518,0.1731834197,0.1925751295,0.4113212435,0.4956518135,0.4795544041,0.6711264249,0.6333937824,1.419091192,1.79742487,2.282602073,2.923607254,3.755928497,4.545324352,5.324846632,6.277217617,6.829854922,7.216659067,8.357315026,9.343092228,9.37444456,9.935291192,10.46907772,11.64196891],
[10.58575378,15.68324347,17.37299725,16.29080468,14.1655282,11.50625738,11.6556526,13.11997617,11.9194487,11.89772021,10.93812124,9.422198964,8.494051813,6.676873575,6.65212228,5.800888083,4.786986528,4.057004145,3.287536788,2.593640415,2.382300518,1.851358549,1.62838342,1.412437306,1.188679793,1.002267358,0.8800176166,0.7447927461,0.8089419689,0.5944404145,0.4184300518,0.3130051813,0.343319171,0.151280829,0.07893678756,0.06393056995,0.0215865285,0.01256580311,0,-0.01730466321,-0.01576062176,-0.02709430052,0.06215647668,0.0815388601,-0.02430984456,0.1658974093,0.3024891192,0.1736062176,0.326465285,0.2416259067,0.4663067358,0.4640880829,0.6095668394,0.649184456,0.8745544041,0.8708518135,1.014596891,1.699566839,2.125698446,2.740105699,3.507556477,4.435884974,4.971729534,6.360928497,7.292078756,8.850944041,10.0560943,11.58700829,13.35521554,16.3751057,19.39499586,11.83104873],
[12.25138964,11.51751813,12.40209845,12.69891917,12.51757617,12.78072642,13.99470881,14.02483627,14.8250715,14.18108601,13.11236373,12.14206425,9.99948601,8.611596891,7.27505285,6.361372021,5.41137513,4.165080829,3.552605181,2.710258031,2.370683938,2.034091192,1.870692228,1.402168912,1.309023834,1.13914715,1.025508808,0.8467533679,0.6994735751,0.8059968912,0.4413233161,0.2381927461,0.1385989637,0.1165606218,0.2083564767,0.1365772021,0.0254507772,0.1149502591,0,0.1943606218,-0.1148031088,-0.1173409326,-0.1508310881,-0.1386839378,-0.1731036269,-0.3284072539,-0.2825129534,-0.2434590674,-0.04922901554,-0.03243937824,0.1580694301,0.2447823834,0.3944559585,0.5474010363,0.7393854922,1.244888083,1.616744041,2.451951295,2.341491192,4.339049741,5.03022487,7.18015544,8.087594819,10.79896062,13.52782798,15.03237617,14.80149016,15.9178943,15.96972642,14.61376269,14.64730259,12.97012124],
[6.872318135,6.769972021,6.817072539,6.664163731,6.632148187,7.776354404,8.189705699,9.395667358,10.61558342,12.08471088,12.60757202,12.55230881,10.43050984,9.47055544,8.424859067,5.998734715,5.465919171,4.648215544,3.209654922,2.346217617,2.108458031,1.435291192,1.153182383,1.11366943,0.8239170984,0.6079751295,0.5445875648,0.4112,0.3067502591,0.1780953368,0.003820725389,-0.1024994819,-0.04676165803,-0.1536518135,-0.03469740933,-0.1416445596,0,0.009616580311,-0.1029295337,0.04243523316,0.01284766839,-0.07645284974,-0.4531554404,-0.3866497409,-0.7689430052,-0.6430093264,-0.6002331606,-0.6902849741,-0.5790559585,-0.4162,-0.2808466321,-0.1715823834,-0.01884041451,0.1257357513,0.4594756477,0.8912611399,1.310576166,1.919645596,2.832353368,3.719152332,5.352341969,7.293589637,10.62244663,13.88198756,14.53673886,14.54724663,12.6045285,11.38291917,9.392003109,9.054494301,7.999690155,6.986894301],
[3.406786528,3.34968601,3.316356477,3.453385492,3.509331606,3.632484974,4.120431088,4.976495337,6.144550259,7.646687047,9.788184456,10.86278756,11.71585492,10.16208083,9.050015544,6.987097409,5.766978238,5.141053886,3.760066321,2.685501554,2.139666321,1.813539896,1.361022798,1.046168912,0.7937823834,0.6392062176,0.4324145078,0.3342632124,0.2212487047,0.05777823834,0.1074072539,0.06223005181,0.01986010363,0.112384456,0,-0.9882051813,0.02505595855,0.005675647668,-0.1454051813,-0.2191388601,-0.07111606218,-0.005083937824,-0.2795233161,-0.5608704663,-0.4463284974,-0.1682404145,-0.2458321244,-0.150026943,-0.06850880829,-0.1993699482,0.02209533679,0.01861658031,0.2311989637,0.402426943,0.5419917098,0.9083968912,1.493909845,2.112041451,3.124978238,4.713602073,8.072472539,10.52824663,13.70239378,13.87562176,11.67277098,9.546276684,7.147381347,5.937290155,5.033829016,4.088306736,3.792836269,3.368565803],
[2.266724352,2.315679793,2.063959585,2.086720207,2.275281865,2.34320829,2.701940933,3.204124352,3.97842487,5.132303627,6.457655959,8.412573057,9.979246632,10.66855959,10.55644663,8.999161658,7.11847772,6.199169948,4.856807254,3.885336788,3.182478756,2.131833161,1.821932642,1.411793782,1.05964456,0.8119699482,0.6091295337,0.5137419689,0.3446497409,0.1801450777,0.01686010363,0.04734300518,-0.06485803109,0.0250134715,0,0.1114207254,0.0350984456,-0.007668393782,-0.04401450777,0.00000621761658,-0.1060227979,-0.06970673575,0.02567357513,0.06645803109,0.01640103627,0.09660414508,0.08362901554,0.03585906736,0.09479170984,0.1060207254,0.04431917098,0.1833119171,0.4071471503,1.86542487,0.7443388601,1.676839378,2.176478756,3.101556477,4.750167876,8.329696373,12.55493264,15.65645389,13.56942798,11.10675648,7.800647668,6.424911917,5.401540933,4.18242487,3.850053886,3.014593782,2.708563731,2.183056995],
[1.573960584,0.9684709389,0.8634392804,2.018411936,2.131037846,2.17380438,1.817216885,2.587589181,2.892982533,3.647481105,5.251196793,6.410462209,8.69649564,12.24357933,10.89820087,14.17971802,12.21172635,11.67134548,8.851093431,6.783786337,5.637988355,3.461365357,3.019042151,2.79313246,2.347664244,1.719934334,1.516413994,1.209313869,0.8676084425,0.6349680233,0.4562492711,0.3448148688,0.4445976676,0.08904505814,0.279775837,0.2639737991,-0.1103698225,0,-0.1462026432,-0.1138629738,-0.026179941,-0.3258674699,0,-0.4581132353,0.1762451994,-0.04405538922,0.07898237885,0.2997699115,-0.1301898148,0.1428809524,0.03972291022,0.2444088889,0.5837572079,0.5958908555,0,1.343523385,2.041043348,3.450029155,8.132716157,13.47563889,20.08672965,21.90673217,13.7846754,12.66031579,6.778920058,6.151774194,3.626047267,2.791165205,2.256806107,1.703823009,0.7793792094,1.833058268],
[1.113426908,1.238993582,0.9445299363,1.080588235,0.9566848958,0.9162036082,1.010611326,1.077349428,1.329642038,2.11762341,2.941275862,3.269146497,3.425141952,4.734437262,7.881492976,8.364278626,11.68577481,10.35253817,8.459429479,7.262601023,5.13486277,3.639330789,2.22484251,1.709478927,1.260752538,0.8117262211,0.8059435173,0.659339719,0.1861176471,0.168317662,-0.09251662404,-0.1688598726,-0.04768894602,0,-0.385292249,-0.9298895105,-0.8313108108,-0.4739243086,-0.5578732212,-0.9051108179,-0.8987666174,-0.7089533074,-0.7677459893,-0.9895655271,-0.9617692308,-0.6923610503,-0.5762591006,-0.6576551724,-0.5004072495,-0.4867550645,-0.4140052083,-0.2056339755,0.2047135231,-0.08396540881,-0.06560342368,0.3811909774,0.9383293233,1.98114479,4.633937419,8.959918182,13.70296332,13.94314497,8.583517375,5.651886624,5.272627551,3.789765766,2.752463731,2.082890605,1.417805913,1.253819121,1.113706965,1.388780206],
[1.749953105,1.741980794,1.965952926,1.78006599,1.741283544,2.11488378,2.316977157,2.753651842,2.884820025,3.372256345,3.093331646,3.77730038,4.437024081,5.105050633,7.431897468,9.576065823,12.96163959,7.847981013,9.049809949,5.006104459,5.058625954,3.735421456,2.446216837,2.392426376,0.365171278,1.405249678,1.396677707,0.8294572158,0.4369106218,0.3827659033,0.8382674271,0.0001962025316,-0.5037512821,-0.1114610473,-0.8602097004,-0.9127874818,-0.9972108262,-0.3910356234,-0.4659671053,-0.556202171,-0.5615841874,-0.3738669355,-0.3907773437,-0.01699488491,-0.2003952569,-0.1771222076,-0.07215074024,-0.2042017937,-0.3540641201,-0.1889665775,0.6236405648,0.7687679487,0.804825641,0.9009536424,1.354521401,1.586880559,2.240153453,4.187918575,7.542560203,11.14605591,13.63486076,10.18676245,6.952434728,5.59438825,4.413784163,3.069132653,2.13417602,1.507084856,1.33681201,1.20756611,1.347252011,1.93439263],
[0.8687784257,0.65616,0.5119605839,0.5738854626,1.009769006,1.156655125,1.303253182,1.492002865,1.721106475,2.689031838,2.131052778,2.482719547,2.759390988,3.461684138,4.264468579,6.123394191,8.542063274,9.946751715,10.48697826,11.08130168,7.554404891,4.014063003,2.812703356,2.408673442,1.274417219,1.212867198,0.8357139073,0.7180658762,0.8359828269,0.1812532982,-0.09619354839,-0.14926,-0.4164073072,-0.7768994413,-0.5963890374,-0.7061564626,-0.7189030899,-0.8623237952,-0.9015356164,-0.9324421669,-0.9972507645,-1.006131805,-0.761340751,-0.5463425414,-0.639119891,-0.398477208,-0.3035704324,-0.198225,-0.1719860031,0.14375,0.09668374817,0.06862765957,0.3083295082,1.252172956,1.247086587,1.945966292,2.218821086,3.910941337,8.424026012,13.12373961,13.86665143,10.36825176,5.342819149,4.715950437,3.287856489,2.021188966,1.569004637,1.220038292,1.165836991,1.196257649,0.88415478,0.6779817352],
[1.398991992,1.372553892,1.226757758,1.386075773,1.570813559,1.668427717,1.893374,1.777981057,2.262201798,2.546733734,2.736500499,2.893535465,3.051431275,3.659646354,4.092111665,5.140950199,6.064688247,7.798297,8.82574004,10.68705994,7.20956487,5.960066066,4.34931968,3.401890329,2.632140299,2.142269,1.009604396,1.084167832,1.329065934,1.130152847,0.7241506986,0.6199350649,0.2870551655,0.1031222445,-0.1973810945,-0.274121393,0.04240343782,-0.4136738022,-0.2604208955,-0.288940404,-0.3558478039,-0.4087848233,-0.3475041408,-0.2467169615,-0.4089721604,-0.3994475138,-0.3200685579,-0.1580084477,-0.3506883408,-0.02317667044,0.4023291995,0.2371638796,0.3722272251,0.4893993471,0.7447906178,1.25810828,2.712639144,3.842207035,8.508401005,11.96433099,10.57106834,7.301505,4.660237237,3.494905,2.880537613,2.385841734,2.100647295,1.736838839,1.591096,1.524466533,0.5716619289,1.1406004],
[0.7364088472,0.8793493151,0.7456213333,0.8242628798,0.786687664,1.279519054,1.153097025,1.621602362,1.859786458,2.501603651,2.702405161,3.157449032,3.296408685,3.485436943,4.210095541,4.843904092,4.548834816,6.16966033,7.390967047,11.96245338,11.72075476,8.804690355,5.212338442,3.99857707,2.888096324,2.33776972,1.485559645,1.339635443,1.308370089,1.081936548,0.7489770115,0.6850012755,0.3949766234,0.4819650259,0.04527858081,0.00981321474,-0.4009211564,-0.6316842105,-0.583692,-0.7639440746,-0.909600311,-0.4917007874,-0.4725382514,-0.5014745763,-0.3611800263,-0.2460354223,-0.06909395973,-0.1570040214,-0.1639863014,0.06002848101,0.03549793673,0.3816939597,0.7407991914,0.6733560372,2.357331126,1.636326951,2.725853138,7.731786172,10.50463718,17.17643291,14.25375669,7.677833333,5.189121982,3.715383226,2.841489637,1.915056209,2.029615741,0.8824567039,0.7228834532,0.5966273932,0.6205041899,0.6740991124],
[0.9634638889,1.059750685,0.7664925976,0.9611436389,1.350841678,1.496285135,1.511784044,1.740828804,2.177997297,2.832372629,3.348823212,3.433072386,4.191640854,3.902802929,3.922362299,4.415072289,4.723129679,5.748217158,7.024350667,9.547989319,10.63459546,10.9777162,7.525668892,5.328104278,4.012168,1.877011984,1.43406275,1.518205607,1.333302667,1.196316,0.7225710456,0.5871148198,0.2135260989,-0.04804240766,0.0007133058985,-0.2498342246,-0.4239711538,-0.2409200542,-0.2291811895,-0.2179210884,-0.4731109551,-0.5008551136,-0.6300914543,-0.5767953846,-0.6078971256,-0.4870030581,-0.5448512518,-0.246673947,-0.2167196402,-0.09669164265,0.1734094077,2.102061538,0.5268256334,0.8237174254,1.187609538,1.474066766,2.292559066,5.114343708,13.60984409,16.01227481,13.19249125,6.951179384,4.969764075,4.031433784,2.10353523,2.042730385,1.436759155,1.228748252,0.9189210155,0.684615495,1.201211712,0.9003138075],
[0.4603585434,0.4209496599,1.235662776,2.014374674,1.611910644,2.009897269,2.145805483,2.118336801,2.156601816,2.840191906,3.546753585,3.547192408,4.401479167,4.186893506,4.366415584,4.276449351,5.132473342,6.223781534,8.533119636,12.2257039,13.98363165,17.51682813,12.2909375,6.935805447,4.191508431,3.491642298,2.95147526,2.530334641,2.350662304,2.533152344,2.181134465,2.278319896,2.145601828,2.009744488,1.680451948,1.646601816,1.107482445,-0.2297896138,1.042466926,-0.2599598394,-0.7259805195,0.1967562254,1.349777922,1.47989857,1.468824903,1.779045752,2.258516927,2.194394018,2.454062581,0.6179616963,0.993218232,1.240382008,1.099873656,1.103349351,2.706428571,5.452674449,15.77006096,12.22548493,15.57827178,9.523876783,7.625983139,5.276708171,1.705772789,1.0605,0.3681793842,0.4784581081,0.2148161669,0.7462945302,0.6356422977,0.5220092838,0.4468415147,0.4129385621],
[0.9150566535,0.7155729304,1.035600791,0.7172509855,0.8416631579,1.984569737,2.102124174,1.936058201,2.065957503,2.118210317,2.303595238,2.72656366,2.69292074,3.214584433,3.078335968,3.218839523,3.509613456,4.91358543,6.301690476,7.916235686,10.40066225,14.17766358,17.17687995,15.25241722,7.286657407,3.649021136,2.387940555,1.682197351,1.024228647,0.8143355263,1.057204993,2.019368212,2.043972185,2.068235837,1.661048877,1.600187335,1.662575397,1.380593668,1.213304749,1.009334651,1.186068331,0.679370224,0.2177011952,0.4290079681,1.001647832,1.61729249,1.153742744,2.094371202,2.614730515,3.274,2.320947297,2.185047306,2.4684,4.036646904,5.154879789,10.93147038,15.79229982,21.29859425,18.04078097,14.08243986,9.098411131,6.708960503,4.299996409,2.507411609,2.375045822,0.9465689882,1.09918775,1.061675066,1.152093668,0.7964472296,0.7644441524,0.9980408432],
[-0.7643358491,-0.8040062893,-0.669608805,-0.6210352201,-0.6045610063,-0.6857144654,-0.6872,-0.5879459119,-0.6737408805,-0.4568981132,-0.2036943396,-0.4207849057,-0.1744540881,-0.3684981132,-0.07887169811,0.2593899371,0.6860339623,1.599618868,3.672259119,5.228387421,6.518477987,9.052142138,9.017489308,8.067340881,2.37112327,1.674099371,0.5916779874,-0.1176591195,-0.5383748428,-0.7724477987,-0.6467132075,-0.5069899371,-1.020836478,-1.425109434,-1.291002516,-1.487216352,-1.464359748,-1.581544654,-1.739374843,0,-1.811813836,-2.072132075,0,-1.969920755,-1.160869182,-0.5204641509,-0.3922113208,-0.5799660377,-0.003303144654,0.5725220126,0.9112251572,1.248953459,1.324023899,2.41367044,4.45274717,7.509450314,12.72466792,15.30814591,7.606238994,4.058543396,2.490374843,0.6277874214,-0.552909434,-0.2692301887,-0.1816440252,0.07346037736,-0.0565572327,-0.2665836478,-0.1128238994,-0.4110213836,-0.513554717,-0.7052289308]]
#[2.200194192,2.293081522,2.319240506,2.356055046,2.233281867,2.646396768,2.569436266,2.434111712,2.626261261,2.769261733,2.883834532,3.847641953,3.536861261,4.314561372,3.960517056,3.974217626,4.989559567,6.761935018,8.460089928,11.24974819,14.05266786,19.86918051,23.56137545,20.48089693,11.98633816,7.373592727,4.449673285,3.238572202,2.451245961,2.045443636,2.429581982,2.69178777,2.643352622,2.687149281,2.36382852,2.099843525,2.245132007,1.881080935,1.53552518,1.299900901,1.527563734,1.071865108,0.8323435805,1.200325455,1.604913669,2.382400359,2.270823741,2.883922523,3.350913669,4.544921818,4.375578947,4.695125899,5.27535,6.376526316,8.193956835,10.52415343,15.97341917,23.00892654,25.78265583,14.24367446,8.976920434,6.805974775,4.892458182,3.607405745,3.520149635,3.045060109,2.870055556,3.212604869,2.827383212,2.869197417,2.537546448,2.750224453]]
)

A[A < -0.6] = 0





blueshift = np.array([
        1.50650549e+00,  9.89632785e-01, -2.41037369e-01, -8.41917217e-01,
       -1.08998454e+00,  7.98244059e-01,  2.17311478e+00,  1.43295527e+00,
        3.06678951e-01, -1.30931707e-02, -5.12566864e-01, -1.08269095e+00,
       -2.02434468e+00, -4.64939356e-01,  7.67751873e-01, -5.65906167e-01,
       -5.49737394e-01,  1.59868491e+00,  2.30545259e+00,  1.42451942e+00,
        1.37416780e+00,  1.71300852e+00,  1.17117977e+00, -1.61687478e-01,
       -1.21608317e+00, -1.75887859e+00, -1.84464324e+00, -6.33129478e-01,
       -3.14060360e-01, -6.15642667e-01,  5.38313866e-01,  1.40922940e+00,
        1.91977513e+00,  2.23049641e+00,  7.02988997e-04, -2.06213045e+00,
       -2.32856321e+00, -2.20501304e+00, -2.53585720e+00, -1.49815750e+00,
       -1.01537979e+00, -1.41995001e+00, -3.25132430e-01, -3.79701942e-01,
       -1.80826354e+00, -1.77452004e+00, -1.17662787e-01,  1.85044289e+00,
        3.01098990e+00,  2.23840499e+00,  1.47469521e+00,  3.90774012e-01,
       -5.66960633e-01,  1.44991484e-02,  1.08313036e+00,  4.95255768e-01,
       -1.16081059e+00,  1.03603005e-01,  1.54130340e+00,  1.24736619e+00,
        4.23375130e-01,  2.58348472e-02, -2.56239504e-01, -8.47980499e-01,
       -3.33656162e-01,  5.65906167e-02,  6.38226151e-01,  8.75484943e-01,
        1.03541493e+00,  1.16344683e-01, -8.87260020e-01, -3.18541914e-01,
        1.47478306e+00,  2.79534793e+00,  2.17100596e+00,  9.80933309e-01,
        6.64412498e-01,  5.62215447e-01,  3.77680868e-01, -5.92268258e-02,
       -3.12830120e-01, -5.79087213e-02, -3.01142931e-01, -3.82689655e-01,
        5.96749783e-01, -4.02461216e-02, -1.31274414e+00, -1.24824488e+00,
       -1.26441360e+00, -3.55009474e-02, -7.53955692e-02, -1.35044193e+00,
        1.85852721e-01,  8.63446295e-01, -2.52812415e-01, -9.40247834e-01,
       -1.06283152e+00, -1.04218125e+00, -4.24517483e-01,  3.15817833e-01,
        8.50440979e-01,  9.50792655e-02, -1.07522166e+00, -5.62654853e-01,
        1.15914106e+00,  1.59464276e+00,  1.44657564e+00,  3.20035756e-01,
       -1.23313057e+00, -1.18462443e+00,  6.35326326e-01,  6.13182187e-01,
        5.14851570e-01,  8.55625510e-01, -5.80229580e-01, -8.74430478e-01,
       -9.32163417e-01, -6.86029434e-01,  1.44112753e-02, -2.24517122e-01,
        5.20563364e-01,  1.49270928e+00,  2.26046109e+00,  5.79438686e-01,
       -3.33041042e-01, -4.35677439e-01, -6.07118905e-01,  4.22408521e-01,
        8.51846933e-01, -4.04218677e-03, -3.09227288e-01, -9.31460485e-02,
        4.14851397e-01,  6.04570545e-02,  3.33216786e-01,  5.26714504e-01,
       -1.11274374e+00, -1.58374643e+00, -3.37346852e-01,  1.22583710e-01,
       -9.67225015e-01, -1.47856164e+00,  1.97715670e-01,  4.84798819e-01,
       -8.00265133e-01, -1.49850893e+00, -9.88578320e-01, -5.16257584e-01,
       -7.53516376e-01, -5.00879670e-03,  5.52373648e-01, -4.60721433e-01,
       -6.91038191e-01, -1.20826237e-01, -3.25835407e-01, -1.28620625e+00,
       -1.94552213e-01, -2.53076050e-02, -7.79175460e-01, -1.28673351e+00,
       -9.13270593e-01, -9.55713570e-01, -4.44992065e-01,  9.72497463e-01,
        1.37733126e+00,  5.22408724e-01, -5.79965934e-02, -2.52460927e-01,
       -1.53866723e-01, -9.71179366e-01, -1.86546922e+00, -7.89544523e-01,
       -3.22584093e-01, -1.25132039e-01,  1.50474799e+00,  1.33453679e+00,
        2.31371269e-01, -3.32162321e-01, -8.62567544e-01, -2.25132242e-01,
        8.11512947e-01, -3.87962073e-01, -9.13007021e-01,  9.42884013e-02,
        5.88489711e-01, -5.93937874e-01, -8.17400515e-01,  5.90159297e-01,
        4.82865572e-01, -6.02022231e-01, -2.01494232e-01, -1.11722529e+00,
       -1.96898437e+00, -1.16933441e+00,  5.31723320e-01,  1.74174321e+00,
        1.30773532e+00,  1.59534574e+00,  1.00219870e+00,  4.49122101e-01,
        3.84447128e-01, -1.49121553e-01, -4.39719647e-01, -2.02724457e-01,
       -7.18015432e-01, -4.62918282e-01,  1.53778851e-01, -6.48068011e-01,
       -2.40984631e+00, -2.91591072e+00, -1.53805208e+00,  3.40861797e-01,
       -6.47716522e-01, -2.11160326e+00, -2.34675312e+00, -2.47074270e+00,
       -1.48559153e+00,  2.27241203e-01,  5.77329755e-01, -2.91301072e-01,
       -3.86643976e-01,  9.92268980e-01,  4.81283873e-01, -1.98155031e-01,
        2.85325676e-01, -2.58612096e-01,  6.35062695e-01,  9.95871842e-01,
       -4.91828710e-01, -6.99210465e-01,  4.41564977e-01,  8.23112249e-01,
        1.75923005e-01,  5.12303263e-02,  1.70914203e-01,  4.53164309e-01,
        1.24894786e+00,  4.85326052e-01,  2.37083048e-01,  4.12390947e-01,
        1.12873673e+00,  1.63181329e+00,  1.56819272e+00,  2.01046085e+00,
        1.01740086e+00, -5.86292863e-01, -8.88490260e-01,  2.38489032e-01,
        3.53779227e-01, -8.67400587e-01, -1.94200724e-01,  9.57119584e-01,
        3.97276670e-01, -2.39895001e-01, -2.62742162e-01,  3.26450527e-01,
       -2.10984588e-01, -5.19948244e-01,  5.06239951e-01,  1.38348246e+00,
        7.24078715e-01,  5.96222579e-01,  4.66696829e-01, -3.17487419e-01,
       -1.97276294e-01,  4.87786502e-01, -9.43762779e-01, -1.68084681e+00,
       -1.46828043e+00, -1.58014357e+00, -2.49297485e-01,  2.02671742e+00,
        2.87513733e+00,  1.63761294e+00,  2.34622583e-02, -7.78296709e-01,
       -1.18901801e+00, -9.70388472e-01, -1.01291931e+00, -1.39112735e+00,
       -4.81459618e-01, -7.64588416e-01,  8.47980529e-02,  1.10369277e+00,
        7.32163072e-01, -5.13181984e-02, -1.25685656e+00, -1.64631248e+00,
       -1.18840289e+00, -1.01986134e+00, -1.65553916e+00, -1.66371143e+00,
       -2.15123439e+00, -1.89991570e+00, -1.88488936e+00,             np.nan,
                   np.nan,             np.nan,             np.nan,             np.nan,
                   np.nan,             np.nan,             np.nan,             np.nan,
                   np.nan,             np.nan, -3.19350338e+00,             np.nan,
                   np.nan,             np.nan, -2.50343180e+00, -1.73049533e+00,
       -1.92065394e+00, -1.55545104e+00, -5.09403408e-01, -4.67399836e-01,
       -9.96750593e-01, -1.94490707e+00, -2.49156880e+00, -1.10940456e+00,
        1.43559146e+00,  1.63761294e+00,  5.85941374e-01,  1.88664675e-01,
       -3.84886488e-02, -3.29086751e-01,  4.98770714e-01,  1.96309686e-01,
        3.06854695e-01, -7.61073470e-01, -1.42188323e+00, -1.63304353e+00,
       -1.54103982e+00, -2.80756235e-01,  1.30140841e-01, -6.89895868e-01,
        4.42531586e-01,  3.17926794e-01, -1.04130244e+00, -1.84842181e+00,
       -2.29271078e+00, -9.77945626e-01,  4.84974563e-01,  8.10897827e-01,
        6.97628736e-01, -1.52021376e-02, -4.99122217e-02,  3.98770511e-01,
        1.05008984e+00,  9.90160048e-01,  5.78296363e-01,  1.92091748e-01,
       -4.54833895e-01, -8.42356622e-01, -9.84711885e-01, -1.04991412e+00,
       -1.68295574e+00, -2.32777238e+00, -9.40511465e-01,  1.53207672e+00,
        3.31204486e+00,  3.16573524e+00,  1.72346544e+00,  5.28472006e-01,
       -7.63533950e-01, -1.41889548e+00, -5.16521215e-01,  8.60546470e-01,
        1.14121485e+00,  5.31371832e-01,  4.24869001e-01,  8.97541225e-01,
       -1.45958096e-01, -1.09332371e+00, -7.39632308e-01,  2.06221819e+00,
        2.04684043e+00,  7.14588344e-01,  1.54692733e+00,  1.74543393e+00,
        1.74139166e+00,  2.09684062e+00,  1.11775255e+00,  1.33383381e+00,
        2.19288635e+00,  1.34209394e+00,  9.66609921e-04,  2.89631486e-01,
        1.43067050e+00,  2.15931869e+00,  2.04191947e+00,  2.03866816e+00,
        2.41529465e+00,  3.18594623e+00,  3.76028824e+00,  3.72882962e+00,
        3.21072674e+00,  3.63023543e+00,  3.98304796e+00,  2.99403024e+00,
        3.03058577e+00,  3.07751012e+00,  3.15870547e+00,  3.69657993e+00,
        4.38190651e+00,  4.98357725e+00,  5.61987019e+00,  6.63586473e+00,
        7.33191204e+00,  7.16574287e+00,  6.47145319e+00,  6.39140034e+00,
        7.24474144e+00,  8.10976887e+00,  8.11679935e+00,  8.20941830e+00,
        8.90432262e+00,  8.90265274e+00,  1.04476471e+01,  1.17532740e+01,
        1.26480904e+01,  1.37171612e+01,  1.59807863e+01,  1.73992424e+01,
        1.87565384e+01,  2.14467888e+01,  2.39294834e+01,  2.60475006e+01,
        2.91544495e+01,  3.22869682e+01,  3.49400482e+01,  3.68399658e+01,
        4.04992867e+01,  4.43101883e+01,  4.64543037e+01,  4.94024658e+01,
        5.44134598e+01,  6.09140854e+01,  6.57195435e+01,  6.85759659e+01,
        7.16488190e+01,  7.53881073e+01,  8.02918015e+01,  8.66276703e+01,
        9.17717896e+01,  9.61067734e+01,  1.00806252e+02,  1.03275414e+02,
        1.05830513e+02,  1.09109077e+02,  1.12260933e+02,  1.16214455e+02,
        1.18855583e+02,  1.20435287e+02,  1.22380463e+02,  1.22178261e+02,
        1.22790215e+02,  1.23733185e+02,  1.22885994e+02,  1.21551811e+02,
        1.20702866e+02,  1.19940559e+02,  1.18385284e+02,  1.16517883e+02,
        1.14830536e+02,  1.12886505e+02,  1.10938171e+02,  1.08867691e+02,
        1.06630608e+02,  1.04059952e+02,  1.02670578e+02,  1.01509415e+02,
        9.80952606e+01,  9.64033432e+01,  9.42758408e+01,  9.11495590e+01,
        8.96642303e+01,  8.73620300e+01,  8.48991089e+01,  8.38663254e+01,
        8.09521713e+01,  7.81248398e+01,  7.62801056e+01,  7.42344971e+01,
        7.19994354e+01,  6.94292145e+01,  6.72780685e+01,  6.52869415e+01,
        6.34163780e+01,  6.24115410e+01,  6.04949303e+01,  5.96059990e+01,
        5.77864876e+01,  5.45842857e+01,  5.19850731e+01,  5.20310287e+01,
        5.06645050e+01,  4.82246971e+01,  4.66593132e+01,  4.36974449e+01,
        4.22216949e+01,  4.10505180e+01,  3.80578918e+01,  3.57319641e+01,
        3.46071815e+01,  3.49949684e+01,  3.36715050e+01,  3.14982147e+01,
        2.99716740e+01,  2.87223740e+01,  2.83127956e+01,  2.85621796e+01,
        2.71282578e+01,  2.60216656e+01,  2.51470604e+01,  2.52288704e+01,
        2.59647236e+01,  2.45018044e+01,  2.26988125e+01,  2.35026798e+01,
        2.31209583e+01,  2.18510075e+01,  2.07503910e+01,  2.10858040e+01,
        2.15905514e+01,  2.23879166e+01,  2.11830807e+01,  2.17371235e+01,
        2.25573368e+01,  2.24758778e+01,  2.14684944e+01,  2.09624290e+01,
        2.26030312e+01,  2.41976738e+01,  2.47373924e+01,  2.46538258e+01,
        2.34417839e+01,  2.27321167e+01,  2.27202530e+01,  2.30011864e+01,
        2.31221008e+01,  2.29246483e+01,  2.35090961e+01,  2.42021542e+01,
        2.44214878e+01,  2.44594479e+01,  2.48385353e+01,  2.65097160e+01,
        2.71476784e+01,  2.63212280e+01,  2.54794865e+01,  2.54625263e+01,
        2.58158665e+01,  2.51329117e+01,  2.34124336e+01,  2.25590935e+01,
        2.22553139e+01,  2.34619064e+01,  2.46090088e+01,  2.32142792e+01,
        2.15814114e+01,  2.14607620e+01,  2.18376503e+01,  2.12150669e+01,
        1.96560116e+01,  1.90408096e+01,  1.99960842e+01,  2.05413399e+01,
        2.08391438e+01,  2.00236759e+01,  1.88205986e+01,  1.78249016e+01,
        1.80935307e+01,  1.66942310e+01,  1.57520504e+01,  1.64886074e+01,
        1.67498550e+01,  1.70112801e+01,  1.78492432e+01,  1.80697174e+01,
        1.80157642e+01,  1.77976608e+01,  1.63314018e+01,  1.63332462e+01,
        1.77408943e+01,  1.88749924e+01,  2.01585617e+01,  2.13698120e+01,
        2.14974918e+01,  1.99604073e+01,  1.94271011e+01,  1.98954678e+01,
        2.14677029e+01,  2.26830826e+01,  2.30556679e+01,  2.30039978e+01,
        2.28820286e+01,  2.30572491e+01,  2.38935432e+01,  2.49055824e+01,
        2.44993439e+01,  2.42250900e+01,  2.48974991e+01,  2.56569023e+01,
        2.53779907e+01,  2.61296635e+01,  2.65999622e+01,  2.62218418e+01,
        2.51673584e+01,  2.60481167e+01,  2.68040047e+01,  2.61678886e+01,
        2.56766739e+01,  2.52599773e+01,  2.56665688e+01,  2.58664818e+01,
        2.43749142e+01,  2.29474068e+01,  2.23242950e+01,  2.19888821e+01,
        2.15442410e+01,  2.09711285e+01,  2.09583874e+01,  2.06176128e+01,
        1.99472256e+01,  2.01807060e+01,  1.95430069e+01,  1.84865017e+01,
        1.84872055e+01,  1.78509121e+01,  1.67216492e+01,  1.59161987e+01,
        1.61031055e+01,  1.61661110e+01,  1.74059200e+01,  1.63032818e+01,
        1.47760382e+01,  1.44936123e+01,  1.32845592e+01,  1.33244543e+01,
        1.33287601e+01,  1.26113596e+01,  1.16236601e+01,  1.04725151e+01,
        8.95432281e+00,  9.33059788e+00,  1.08458023e+01,  1.02651339e+01,
        9.50080872e+00,  8.96574593e+00,  9.07567596e+00,  1.00628481e+01,
        9.78147697e+00,  8.27488422e+00,  7.63024282e+00,  8.78305721e+00,
        1.00284901e+01,  9.49096680e+00,  8.47558689e+00,  7.58498812e+00,
        6.08164597e+00,  5.27030849e+00,  5.84034491e+00,  5.19359493e+00,
        5.52215433e+00,  6.34060955e+00,  5.67127609e+00,  3.63990140e+00,
        2.15720963e+00,  4.76714420e+00,  7.04184103e+00,  6.62347460e+00,
        5.47725105e+00,  5.37821770e+00,  5.33718061e+00,  4.45756531e+00,
        2.67250061e+00,  2.29350162e+00,  2.35404658e+00,  2.39657736e+00,
        3.30624533e+00,  4.26477098e+00,  5.03937674e+00,  4.23419094e+00,
        2.80255365e+00,  3.41828418e+00,  4.12944555e+00,  2.70615625e+00,
        8.90774965e-01,  3.59666765e-01,  9.76891100e-01,  2.05105829e+00,
        2.10817623e+00,  1.57785892e+00,  2.73954821e+00,  3.17074418e+00,
        2.36221886e+00,  1.73532844e+00,  1.63726139e+00,  2.62821245e+00,
        3.53515601e+00,  2.60712266e+00,  1.59806979e+00,  1.13321829e+00,
        2.03515315e+00,  2.47689390e+00,  1.01063454e+00, -5.36380649e-01,
       -4.39192384e-01,  5.71881592e-01,  1.67715609e+00,  1.02803361e+00,
        2.33304486e-01,  7.07822084e-01,  1.19956291e+00,  1.37434348e-01,
       -8.03867936e-01, -1.16256811e-01,  1.28154898e+00,  1.15035367e+00,
        1.71986270e+00,  1.64139152e+00,  1.09929912e-01,  4.29702044e-01,
        4.40774113e-01, -8.73376012e-01, -1.50123310e+00, -1.18506372e+00,
       -3.87171209e-01, -7.93235242e-01, -1.06432533e+00,  8.91038552e-02,
        1.78084695e+00,  1.05149579e+00,  2.39455640e-01,  1.65870261e+00,
        1.22882485e+00, -1.16476488e+00, -1.96617246e+00,  6.05449304e-02,
        2.45255291e-01,  3.21881086e-01,  3.90422523e-01,  4.10457730e-01,
        1.14262080e+00,  7.62655199e-01, -8.08525264e-01, -2.49912605e-01,
       -3.09315175e-01, -6.40774488e-01, -9.74254906e-01, -1.25263858e+00,
       -1.64200664e+00, -2.18585658e+00, -1.73840404e+00, -7.77593732e-01,
       -2.90334463e-01,  1.70299098e-01,  5.48243582e-01, -3.89895290e-01,
       -2.17434502e+00, -1.25492322e+00, -4.63533401e-01, -1.08066988e+00,
       -1.44578481e+00, -7.41038322e-01, -1.18014283e-01,  1.23980904e+00,
        1.75378191e+00,  6.62567139e-01, -8.28648329e-01, -4.91565078e-01,
        4.66521084e-01,  2.51582205e-01, -2.36380063e-02,  3.87259066e-01,
        7.25045323e-01,  2.75923193e-01, -3.33128929e-01, -7.07119107e-01,
       -4.23111528e-01, -3.87259066e-01,  7.80405700e-01,  2.32522416e+00,
        1.47346497e+00,  6.33305252e-01,  2.15984583e+00,  3.25694823e+00,
        2.41388845e+00,  1.05140793e+00,  1.03225148e+00,  8.06152642e-01,
        5.09667024e-03, -9.90775168e-01, -3.22320461e-01,  1.47030151e+00,
        2.35334373e+00,  2.44086576e+00,  2.36450362e+00,  2.68260622e+00,
        3.50879407e+00,  2.07856274e+00,  1.02240968e+00,  5.20475507e-01,
        1.33040667e-01,  2.41283417e+00,  4.09253836e+00,  4.51143217e+00,
        4.82716179e+00,  5.80932570e+00,  6.50141811e+00,  4.90466642e+00])









#logged = np.log(A)
#print(A)
nans, x= nan_helper(redshift)
redshift[nans]= np.interp(x(nans), x(~nans), redshift[~nans])

nans, x= nan_helper(blueshift)
blueshift[nans]= np.interp(x(nans), x(~nans), blueshift[~nans])


def simulate(l, b, beamwidth=0.6, v_min=-400, v_max=400, plot_file=''):
    global redshift, frequency_obs
    import requests
    import matplotlib
    import matplotlib.pyplot as plt

    if plot_file != '':
        plt.rcParams['figure.figsize'] = (9,7)
    plt.rcParams['legend.fontsize'] = 12
    plt.rcParams['axes.labelsize'] = 12
    plt.rcParams['axes.titlesize'] = 16
    plt.rcParams['xtick.labelsize'] = 12
    plt.rcParams['ytick.labelsize'] = 12

    # Establish velocity limits
    if v_min < -400:
        v_min = -400
    if v_max > 400:
        v_max = 400

	# Download LAB Survey HI data
    response = requests.get('https://www.astro.uni-bonn.de/hisurvey/euhou/LABprofile/download.php?ral='+str(l)+'&decb='+str(b)+'&csys=0&beam='+str(beamwidth))
    data = response.content

	# Parse data
    data = data.splitlines()
    data = data[4:]
	#data = [' '.join(line.split()).replace('\n', '') for line in data]
    frequency = []
    spectrum = []
    for line in data:
        try:
            frequency.append(float(line.split()[2]))
            spectrum.append(float(line.split()[1]))
        except IndexError:
            break

    # Convert km/s to m/s
    v_min = v_min*1000
    v_max = v_max*1000

    # Define Frequency limits
    #print(v_min,v_max)
    left_frequency_edge = 1420.4057517667 + 1420.4057517667e6 * -v_max/(299792458 * 1e6)
    right_frequency_edge = 1420.4057517667 + 1420.4057517667e6 * -v_min/(299792458 * 1e6)
    #print(left_frequency_edge,right_frequency_edge)

    fig, ax = plt.subplots()

    #try:
    plt.title('Simulated HI Profile ($l='+str(l)+'^\circ, b='+str(b)+'^\circ$)')
    #except: # Catch missing TeX exception
    #plt.title('Simulated HI Profile (l='+str(l)+' deg, b='+str(b)+' deg) | Beamwidth: '+str(beamwidth)+' deg', pad=40)

	# Plot data
    ax.plot(frequency, spectrum, label='LAB Survey', color='#1f77b4')
    #ax.set_ylim(-5,130)
    ax.set_xlabel('Frequency (MHz)')
    ax.set_ylabel('Brightness Temperature (K)')
    #print(left_frequency_edge, right_frequency_edge)
    #ax.set_xlim(left_frequency_edge, right_frequency_edge)
    ax.ticklabel_format(useOffset=False)
    #ax.legend(loc='upper left')

    # Set secondary axis for Radial Velocity
    ax_secondary = ax.twinx()
    #ax_secondary.tick_params(top=True, labeltop=True, left=True, labelleft=True, right=True, labelright=True, bottom=True, labelbottom=True)
    ax_secondary.plot(frequency_obs, redshift, label='PICTOR Telescope', color='#d62728')
    ax_secondary.plot(1419,0,label='LAB Survey (Kalberla et al., 2005)', color='#1f77b4')
    #ax_secondary.set_xlabel('Radial Velocity (km/s)', labelpad=5)
    #ax_secondary.yaxis.tick_right()
    #ax_secondary.yaxis.set_ticks_position('right')
    ax_secondary.set_ylabel('Signal-to-Noise Ratio (S/N)')
    ax_secondary.legend(loc='upper left')
    #ax_secondary.axvline(x=0, color='brown', linestyle='--', linewidth=2, zorder=0)

    ax_secondary.set_xlim(1420-(2.5/2)-0.035,1420+(2.5/2)-0.035) #(v_max/1000, v_min/1000)
    #ax_secondary.tick_params(axis='x', direction='in', pad=2)
    ax.grid()

    if plot_file != '':
        # Save plot to file
        plt.savefig(plot_file, bbox_inches='tight', pad_inches=0.1)
    else:
        # Display plot
        plt.show()

#simulate(l=232, b=4, v_min=-178, v_max=349, beamwidth=9.4)
fig, ax = plt.subplots(1,1)

#ax.plot(frequency_obs, redshift)
#ax.plot(frequency_obs, redshift, label='PICTOR Telescope', color='#d62728', lw=2)

ax.plot(frequency_obs, redshift, label='PICTOR Telescope', color='#bd3131', lw=2)
ax.ticklabel_format(useOffset=False)
#ax.set_xticks(np.arange(min(frequency_obs), max(frequency_obs)+1, 0.5))
ax.set_xticks(ax.get_xticks()[::2])
#ax.fill_between(frequency_obs, blueshift, color='#deebf7')
ax.set_ylim()
ax.fill_between(frequency_obs, -100, redshift, where=redshift>-100, interpolate=True, color='#f7dede')
#ax.set_xlim(1419.48242,1420+(2.5/2))
ax.set_xlim(1419.26758,1420+2.5/2)
ax.grid()
ax.set_xlabel('Frequency (MHz)')
ax.set_ylabel('Signal-to-Noise Ratio (S/N)')
#ax.ticklabel_format(useOffset=False)
ax_secondary = ax.twiny()
#ax_secondary.tick_params(top=True, labeltop=True, left=True, labelleft=True, right=True, labelright=True, bottom=True, labelbottom=True)
#ax_secondary.plot(1419,0,label='LAB Survey (Kalberla et al., 2005)', color='#1f77b4')
ax_secondary.set_xlabel('Radial Velocity (km/s)', labelpad=8)
ax_secondary.set_xlim(240.57, -178.08214812535138) #240.57
ax_secondary.axvline(x=0, color='blue', linestyle='--', linewidth=2, zorder=0)
ax_secondary.annotate('Hydrogen Line\nRest Frequency', xy=(441-33, 9), xycoords='axes points', size=22, ha='right', va='bottom', color='blue')

#plt.show()
plt.savefig('redshift.png', bbox_inches='tight')
#plt.plot(redshift)

#plt.show()
#fig, ax = plt.subplots(1, 1)
#for ax, interp in zip(axs, ['nearest', 'bilinear', 'bicubic']):
#methods = ['none', 'nearest', 'bilinear', 'bicubic', 'spline16',
#           'spline36', 'hanning', 'hamming', 'hermite', 'kaiser', 'quadric',
#           'catrom', 'gaussian', 'bessel', 'mitchell', 'sinc', 'lanczos']
#methods = ['gaussian', 'none']
methods = ['gaussian']
for method in methods:
    fig, ax = plt.subplots(1,1)

    img = ax.imshow(np.fliplr(A), cmap='inferno', interpolation=method, extent=[0,360,-7,68])
    x_label_list = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24']
    #plt.xticks(A, [0,3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,72])

    ax.set_xticks(np.arange(0,360.0001,15))
    ax.set_xticklabels(np.arange(24.0001)[::-1].astype(int))

    ax.set_yticks(np.arange(-7, 68.0001, 10))
    #ax.set_yticks(np.arange(-2,68,5))
    #ax.set_yticklabels(np.arange(24.0001).astype(int))
    ax.set_title('PICTOR Telescope | Northern Sky HI Survey', y=1.02)
    ax.set_xlabel('Athens, Greece', labelpad=5)
    ax.set_ylabel('Declination ($^\circ$)', labelpad=-5)
    fig.colorbar(img,shrink=0.5,orientation="horizontal",pad=0.2).set_label("Mean S/N | Mask $\in [-169,42]$ km/s")#ax.set_xlim(0,50)
    #ax.set_xticklabels([0,10,20])
    #plt.colorbar()
    #ax.set_title('interp'.capitalize())
    #ax.grid(True)
    #plt.tight_layout()
    #plt.text(5, 10, 'Interpolation method: e', fontsize=14, bbox={'facecolor': 'white', 'pad': 4})
    plt.savefig(method+'.png', bbox_inches='tight')

    #plt.show()
    break
